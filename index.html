<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç­‹ãƒˆãƒ¬è¨˜éŒ² & ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ææ¡ˆã‚¢ãƒ—ãƒª</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #999;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
            font-size: 14px;
        }

        select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }

        .three-cols {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .record-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s;
            margin-top: 10px;
        }

        .record-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .suggestion-section {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            display: none;
        }

        .suggestion-section h2 {
            color: #d35400;
            margin-bottom: 20px;
        }

        .suggestion-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .suggestion-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .suggestion-item {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .charts-section {
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .chart-container h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .history-section {
            margin-top: 30px;
        }

        .history-section h2 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .history-group {
            margin-bottom: 25px;
        }

        .history-group h3 {
            color: #764ba2;
            margin-bottom: 10px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 8px;
        }

        .history-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .history-item strong {
            color: #667eea;
        }

        .export-btn {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s;
            margin-right: 10px;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(56, 239, 125, 0.4);
        }

        .clear-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .clear-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .message {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .exercise-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 14px;
            color: #1565c0;
            display: none;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            background: #667eea;
            color: white;
            border-radius: 5px;
            font-size: 12px;
            margin-right: 5px;
        }

        .asuka-comment {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid #e17055;
            font-size: 16px;
            font-weight: bold;
            color: #2d3436;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .asuka-comment::before {
            content: "ğŸ‘§ æ˜æ—¥é¦™: ";
            color: #e17055;
        }

        .previous-set-info {
            background: #e8f5e9;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
            color: #2e7d32;
            border-left: 4px solid #4caf50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’ª ç­‹ãƒˆãƒ¬è¨˜éŒ²ã‚¢ãƒ—ãƒª</h1>
        <p class="subtitle">ç§‘å­¦çš„ãªã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ææ¡ˆã§åŠ¹ç‡çš„ã«æˆé•·</p>

        <div id="message" class="message"></div>
        <div id="asukaComment" class="asuka-comment" style="display: none;"></div>

        <!-- å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="input-section">
            <h2 style="color: #667eea; margin-bottom: 20px;">ğŸ“ ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°è¨˜éŒ²</h2>
            
            <div class="input-group">
                <label>ç¨®ç›®ã‚’é¸æŠ</label>
                <select id="exercise" onchange="showExerciseInfo()">
                    <option value="">-- ç¨®ç›®ã‚’é¸æŠ --</option>
                    <optgroup label="èƒ¸">
                        <option value="ãƒ™ãƒ³ãƒãƒ—ãƒ¬ã‚¹">ãƒ™ãƒ³ãƒãƒ—ãƒ¬ã‚¹</option>
                        <option value="ã‚¤ãƒ³ã‚¯ãƒ©ã‚¤ãƒ³ãƒ™ãƒ³ãƒãƒ—ãƒ¬ã‚¹">ã‚¤ãƒ³ã‚¯ãƒ©ã‚¤ãƒ³ãƒ™ãƒ³ãƒãƒ—ãƒ¬ã‚¹</option>
                        <option value="ãƒ€ãƒ³ãƒ™ãƒ«ãƒ•ãƒ©ã‚¤">ãƒ€ãƒ³ãƒ™ãƒ«ãƒ•ãƒ©ã‚¤</option>
                    </optgroup>
                    <optgroup label="èƒŒä¸­">
                        <option value="ãƒ‡ãƒƒãƒ‰ãƒªãƒ•ãƒˆ">ãƒ‡ãƒƒãƒ‰ãƒªãƒ•ãƒˆ</option>
                        <option value="ãƒ©ãƒƒãƒˆãƒ—ãƒ«ãƒ€ã‚¦ãƒ³">ãƒ©ãƒƒãƒˆãƒ—ãƒ«ãƒ€ã‚¦ãƒ³</option>
                        <option value="ãƒ™ãƒ³ãƒˆã‚ªãƒ¼ãƒãƒ¼ãƒ­ã‚¦">ãƒ™ãƒ³ãƒˆã‚ªãƒ¼ãƒãƒ¼ãƒ­ã‚¦</option>
                        <option value="æ‡¸å‚">æ‡¸å‚</option>
                    </optgroup>
                    <optgroup label="è„š">
                        <option value="ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆ">ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆ</option>
                        <option value="ãƒ¬ãƒƒã‚°ãƒ—ãƒ¬ã‚¹">ãƒ¬ãƒƒã‚°ãƒ—ãƒ¬ã‚¹</option>
                        <option value="ãƒ¬ãƒƒã‚°ã‚«ãƒ¼ãƒ«">ãƒ¬ãƒƒã‚°ã‚«ãƒ¼ãƒ«</option>
                        <option value="ãƒ¬ãƒƒã‚°ã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³">ãƒ¬ãƒƒã‚°ã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³</option>
                    </optgroup>
                    <optgroup label="è‚©">
                        <option value="ã‚·ãƒ§ãƒ«ãƒ€ãƒ¼ãƒ—ãƒ¬ã‚¹">ã‚·ãƒ§ãƒ«ãƒ€ãƒ¼ãƒ—ãƒ¬ã‚¹</option>
                        <option value="ã‚µã‚¤ãƒ‰ãƒ¬ã‚¤ã‚º">ã‚µã‚¤ãƒ‰ãƒ¬ã‚¤ã‚º</option>
                        <option value="ãƒªã‚¢ãƒ‡ãƒ«ãƒˆ">ãƒªã‚¢ãƒ‡ãƒ«ãƒˆ</option>
                    </optgroup>
                    <optgroup label="è…•">
                        <option value="ãƒãƒ¼ãƒ™ãƒ«ã‚«ãƒ¼ãƒ«">ãƒãƒ¼ãƒ™ãƒ«ã‚«ãƒ¼ãƒ«</option>
                        <option value="ãƒˆãƒ©ã‚¤ã‚»ãƒ—ã‚¹ãƒ—ãƒ¬ã‚¹ãƒ€ã‚¦ãƒ³">ãƒˆãƒ©ã‚¤ã‚»ãƒ—ã‚¹ãƒ—ãƒ¬ã‚¹ãƒ€ã‚¦ãƒ³</option>
                        <option value="ãƒ€ãƒ³ãƒ™ãƒ«ã‚«ãƒ¼ãƒ«">ãƒ€ãƒ³ãƒ™ãƒ«ã‚«ãƒ¼ãƒ«</option>
                    </optgroup>
                </select>
                <div id="exerciseInfo" class="exercise-info"></div>
                <div id="previousSetInfo" class="previous-set-info" style="display: none;"></div>
            </div>

            <div class="three-cols">
                <div class="input-group">
                    <label>é‡é‡ (kg)</label>
                    <input type="number" id="weight" placeholder="50" step="0.5" min="0">
                </div>
                <div class="input-group">
                    <label>å›æ•°</label>
                    <input type="number" id="reps" placeholder="10" min="1">
                </div>
                <div class="input-group">
                    <label>ã‚»ãƒƒãƒˆæ•°</label>
                    <input type="number" id="sets" placeholder="3" min="1">
                </div>
            </div>

            <button class="record-btn" onclick="recordWorkout()">è¨˜éŒ²ã™ã‚‹</button>
        </div>

        <!-- ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ææ¡ˆ -->
        <div id="suggestionSection" class="suggestion-section">
            <h2>ğŸ“ˆ æ¬¡å›ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ææ¡ˆ</h2>
            <div id="suggestionContent"></div>
        </div>

        <!-- ã‚°ãƒ©ãƒ•ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="charts-section">
            <div class="chart-container">
                <h3>ğŸ“Š ç·è² è·é‡ã®æ¨ç§»</h3>
                <canvas id="volumeChart"></canvas>
            </div>
            <div class="chart-container">
                <h3>ğŸ‹ï¸ ç¨®ç›®åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h3>
                <canvas id="exerciseChart"></canvas>
            </div>
        </div>

        <!-- ãƒœã‚¿ãƒ³ -->
        <div class="button-group">
            <button class="export-btn" onclick="exportToMarkdown()">ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
            <button class="clear-btn" onclick="clearAllData()">å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢</button>
        </div>

        <!-- å±¥æ­´ -->
        <div class="history-section">
            <h2>ğŸ“š ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å±¥æ­´</h2>
            <div id="historyContent"></div>
        </div>
    </div>

    <script>
        // æ˜æ—¥é¦™ã®ã‚³ãƒ¡ãƒ³ãƒˆé›†
        const asukaComments = {
            success: [
                "ã‚„ã‚‹ã˜ã‚ƒãªã„ï¼å‰å›ã‚ˆã‚Šé‡é‡ä¸ŠãŒã£ã¦ã‚‹ã‚ã‚ˆï¼ã‚¢ã‚¿ã‚·ãŒæŒ‡å°ã—ãŸç”²æ–ãŒã‚ã£ãŸã‚ã­ï¼",
                "å½“ç„¶ã®çµæœã­ï¼ã‚¢ã‚¿ã‚·ã®è¨€ã†é€šã‚Šã«ã‚„ã‚Œã°ã“ã†ãªã‚‹ã®ã‚ˆï¼æ¬¡ã‚‚æœŸå¾…ã—ã¦ã‚‹ã‚ï¼",
                "ãµã‚“ã€ã¾ã‚ã¾ã‚ã˜ã‚ƒãªã„ã€‚ã‚¢ã‚¿ã‚·ãªã‚‰ã‚‚ã£ã¨ä½™è£•ã ã‘ã©...ã§ã‚‚ã€æ‚ªããªã„ã‚ï¼",
                "è¦‹ãªã•ã„ã‚ˆï¼ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰æˆåŠŸï¼ã‚¢ãƒ³ã‚¿ã‚‚ã‚„ã‚Œã°ã§ãã‚‹ã˜ã‚ƒãªã„ï¼",
                "å®Œç’§ï¼ã•ã™ãŒã‚¢ã‚¿ã‚·ãŒæ•™ãˆã¦ã‚‹ç”Ÿå¾’ã­ï¼ã“ã®èª¿å­ã§çªãé€²ã¿ãªã•ã„ï¼",
                "ã¡ã‚‡ã£ã¨ã€ã‚¢ãƒ³ã‚¿æ‰èƒ½ã‚ã‚‹ã‹ã‚‚ã­ï¼...ã¹ã€åˆ¥ã«è¤’ã‚ã¦ã‚‹ã‚ã‘ã˜ã‚ƒãªã„ã‚“ã ã‹ã‚‰ï¼",
                "ã„ã„ã‚ã‚ˆãã®èª¿å­ï¼ã‚¢ã‚¿ã‚·ã«è¿½ã„ã¤ã‘ã‚‹ã‚ˆã†ã«é ‘å¼µã‚Šãªã•ã„ï¼ã¾ã ã¾ã ã ã‘ã©ã­ï¼",
                "ã¸ã‡ã€ã‚„ã‚‹ã˜ã‚ƒãªã„ï¼ã§ã‚‚ã‚¢ã‚¿ã‚·ã¨æ¯”ã¹ãŸã‚‰ã¾ã ã¾ã ã‚ˆï¼ã‚‚ã£ã¨ä¸Šã‚’ç›®æŒ‡ã—ãªã•ã„ï¼",
                "ç´ æ™´ã‚‰ã—ã„ã‚ï¼ã“ã®èª¿å­ãªã‚‰ã‚¢ãƒ³ã‚¿ã‚‚ä¸€æµã«ãªã‚Œã‚‹ã‹ã‚‚ã­ï¼...ã‚¢ã‚¿ã‚·ã»ã©ã˜ã‚ƒãªã„ã‘ã©ã€‚",
                "ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆï¼ã‚¢ã‚¿ã‚·ãŒè¦‹è¾¼ã‚“ã ã ã‘ã‚ã‚‹ã‚ï¼æ¬¡ã¯ã‚‚ã£ã¨é«˜ã¿ã‚’ç›®æŒ‡ã™ã‚ã‚ˆï¼"
            ],
            failure: [
                "ã¡ã‚‡ã£ã¨ï¼ä½•ã‚„ã£ã¦ã‚“ã®ã‚ˆï¼...ã¾ã‚ã€ç–²ã‚Œã¦ã‚‹æ—¥ã‚‚ã‚ã‚‹ã‚ã‚ˆã­ã€‚ä»Šæ—¥ã¯ä¼‘ã¿ãªã•ã„ã€‚",
                "ã¯ãï¼Ÿå‰å›ã¨åŒã˜ï¼Ÿ...ã¹ã€åˆ¥ã«æ°—ã«ã™ã‚‹ã“ã¨ãªã„ã‚ã‚ˆï¼æ¬¡é ‘å¼µã‚Œã°ã„ã„ã‚“ã ã‹ã‚‰ï¼",
                "ã‚¢ãƒ³ã‚¿ã€ç„¡ç†ã—ã¦ãªã„ï¼Ÿ...ãƒã‚«ã­ã€æ€ªæˆ‘ã—ãŸã‚‰å…ƒã‚‚å­ã‚‚ãªã„ã§ã—ã‚‡ï¼",
                "ãµã‚“ã€èª¿å­æ‚ªã„ã®ï¼Ÿã—ã‚‡ã†ãŒãªã„ã‚ã­...æ „é¤Šã¨ç¡çœ ã¯ã¡ã‚ƒã‚“ã¨å–ã‚Šãªã•ã„ã‚ˆï¼",
                "ãƒ€ãƒ¡ãƒ€ãƒ¡ã­ï¼...ã£ã¦è¨€ã„ãŸã„ã¨ã“ã ã‘ã©ã€ã‚ªãƒ¼ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚ˆã‚Šãƒã‚·ã‚ˆã€‚",
                "ã‚ãƒ¼ã‚ã€é‡é‡ä¸ŠãŒã‚“ãªã‹ã£ãŸã‚ã­ã€‚ã§ã‚‚ç„¡ç†ã—ã¦æ€ªæˆ‘ã™ã‚‹ã‚ˆã‚Šã„ã„ã‚ã€‚æ¬¡ï¼",
                "ä½•ã‚ˆãã®è¨˜éŒ²ï¼...ã¾ã€ã¾ã‚ä½“èª¿æ‚ªã„æ—¥ã‚‚ã‚ã‚‹ã‚ã‚ˆã­ã€‚æ¬¡ã¯æœ¬æ°—å‡ºã—ãªã•ã„ã‚ˆï¼",
                "ã¡ã‚‡ã£ã¨ãƒ¼ï¼ã‚‚ã£ã¨æ°—åˆã„å…¥ã‚Œãªã•ã„ã‚ˆï¼...ã£ã¦ã€ä½“èª¿æ‚ªãã†ã­ã€‚ä»Šæ—¥ã¯è¨±ã—ã¦ã‚ã’ã‚‹ã€‚",
                "ã¯ã...ã‚¢ãƒ³ã‚¿ã‚‰ã—ããªã„ã‚ã­ã€‚ç–²ã‚Œã¦ã‚‹ãªã‚‰ç´ ç›´ã«ä¼‘ã¿ãªã•ã„ï¼ã‚¢ã‚¿ã‚·ãŒè¨€ã†ã‚“ã ã‹ã‚‰ï¼",
                "å‰å›è¶…ãˆã‚‰ã‚Œãªã‹ã£ãŸï¼Ÿåˆ¥ã«ã„ã„ã‚ã‚ˆï¼ç¶™ç¶šãŒå¤§äº‹ãªã‚“ã ã‹ã‚‰ï¼...ã‚ã‹ã£ã¦ã‚‹ã§ã—ã‚‡ã†ã­ï¼"
            ]
        };

        // ç¨®ç›®ã”ã¨ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰æˆ¦ç•¥
        const exerciseStrategies = {
            'ãƒ™ãƒ³ãƒãƒ—ãƒ¬ã‚¹': {
                type: 'compound',
                repRange: '5-8',
                description: 'BIG3ã®ä¸€ã¤ã€‚é‡é‡é‡è¦–ã§2.5kgåˆ»ã¿ã§å¢—åŠ ã€‚',
                strategy: 'é‡é‡ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 1.25, 5],
                tips: 'ãƒ•ã‚©ãƒ¼ãƒ ç¶­æŒãŒæœ€å„ªå…ˆã€‚è‚©ã‚’ä¸‹ã’ã¦èƒ¸ã‚’å¼µã‚‹ã€‚',
                bodyPart: 'èƒ¸'
            },
            'ã‚¤ãƒ³ã‚¯ãƒ©ã‚¤ãƒ³ãƒ™ãƒ³ãƒãƒ—ãƒ¬ã‚¹': {
                type: 'compound',
                repRange: '6-10',
                description: 'ä¸Šéƒ¨èƒ¸ç­‹ç‹™ã„ã€‚é€šå¸¸ã®ãƒ™ãƒ³ãƒã‚ˆã‚Šè»½ã‚ã®é‡é‡ã€‚',
                strategy: 'å›æ•°ã¨é‡é‡ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆã',
                weightIncrements: [2.5, 1.25],
                tips: 'è§’åº¦ã¯30-45åº¦ãŒæœ€é©ã€‚',
                bodyPart: 'èƒ¸'
            },
            'ãƒ€ãƒ³ãƒ™ãƒ«ãƒ•ãƒ©ã‚¤': {
                type: 'isolation',
                repRange: '10-15',
                description: 'èƒ¸ç­‹ã®ã‚¹ãƒˆãƒ¬ãƒƒãƒç¨®ç›®ã€‚ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«é‡è¦–ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 1.25],
                tips: 'ã‚†ã£ãã‚Šé™ã‚ã—ã¦èƒ¸ã®ã‚¹ãƒˆãƒ¬ãƒƒãƒã‚’æ„Ÿã˜ã‚‹ã€‚',
                bodyPart: 'èƒ¸'
            },
            'ãƒ‡ãƒƒãƒ‰ãƒªãƒ•ãƒˆ': {
                type: 'compound',
                repRange: '3-6',
                description: 'BIG3ã®ç‹æ§˜ã€‚å…¨èº«ã‚’ä½¿ã†é«˜é‡é‡ç¨®ç›®ã€‚',
                strategy: 'é‡é‡ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [5, 2.5, 10],
                tips: 'èƒŒä¸­ã‚’ä¸¸ã‚ãªã„ã€‚è…°ã‚’å®ˆã‚‹ãŸã‚ãƒ™ãƒ«ãƒˆæ¨å¥¨ã€‚',
                bodyPart: 'èƒŒä¸­'
            },
            'ãƒ©ãƒƒãƒˆãƒ—ãƒ«ãƒ€ã‚¦ãƒ³': {
                type: 'compound',
                repRange: '8-12',
                description: 'èƒŒä¸­ã®åºƒãŒã‚Šã‚’ä½œã‚‹ã€‚æ‡¸å‚ã®ä»£æ›¿ç¨®ç›®ã€‚',
                strategy: 'å›æ•°ã¨é‡é‡ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆã',
                weightIncrements: [2.5, 5],
                tips: 'è‚©ç”²éª¨ã‚’å¯„ã›ã¦èƒ¸ã«å¼•ãæ„è­˜ã€‚',
                bodyPart: 'èƒŒä¸­'
            },
            'ãƒ™ãƒ³ãƒˆã‚ªãƒ¼ãƒãƒ¼ãƒ­ã‚¦': {
                type: 'compound',
                repRange: '6-10',
                description: 'èƒŒä¸­ã®åšã¿ã‚’ä½œã‚‹ã€‚è…°ã¸ã®è² æ‹…ã«æ³¨æ„ã€‚',
                strategy: 'é‡é‡ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 5],
                tips: 'è†ã‚’è»½ãæ›²ã’ã¦èƒŒä¸­ã¯ã¾ã£ã™ãã€‚',
                bodyPart: 'èƒŒä¸­'
            },
            'æ‡¸å‚': {
                type: 'compound',
                repRange: '5-12',
                description: 'è‡ªé‡ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ç‹é“ã€‚åŠ é‡ã§è² è·èª¿æ•´ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 5],
                tips: 'å®Œå…¨ã«é™ã‚ã—ã¦å®Œå…¨ã«ä¸Šã’ã‚‹ã€‚',
                bodyPart: 'èƒŒä¸­'
            },
            'ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆ': {
                type: 'compound',
                repRange: '5-8',
                description: 'BIG3ã®ä¸€ã¤ã€‚ä¸‹åŠèº«å…¨ä½“ã‚’é›ãˆã‚‹ã€‚',
                strategy: 'é‡é‡ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [5, 2.5, 10],
                tips: 'è†ãŒã¤ã¾å…ˆã‚ˆã‚Šå‰ã«å‡ºãªã„ã‚ˆã†ã«ã€‚æ·±ãé™ã‚ã™ã€‚',
                bodyPart: 'è„š'
            },
            'ãƒ¬ãƒƒã‚°ãƒ—ãƒ¬ã‚¹': {
                type: 'compound',
                repRange: '8-12',
                description: 'è…°ã¸ã®è² æ‹…ãŒå°‘ãªã„è„šç¨®ç›®ã€‚é«˜é‡é‡å¯èƒ½ã€‚',
                strategy: 'é‡é‡ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [5, 10, 2.5],
                tips: 'è†ã‚’å®Œå…¨ã«ãƒ­ãƒƒã‚¯ã—ãªã„ã€‚',
                bodyPart: 'è„š'
            },
            'ãƒ¬ãƒƒã‚°ã‚«ãƒ¼ãƒ«': {
                type: 'isolation',
                repRange: '10-15',
                description: 'ãƒãƒ ã‚¹ãƒˆãƒªãƒ³ã‚°é›†ä¸­ã€‚ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«é‡è¦–ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 5],
                tips: 'ã‚†ã£ãã‚Šé™ã‚ã—ã¦ã‚¹ãƒˆãƒ¬ãƒƒãƒã‚’æ„Ÿã˜ã‚‹ã€‚',
                bodyPart: 'è„š'
            },
            'ãƒ¬ãƒƒã‚°ã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³': {
                type: 'isolation',
                repRange: '10-15',
                description: 'å¤§è…¿å››é ­ç­‹é›†ä¸­ã€‚è†ã«è² æ‹…ã‹ã‹ã‚Šã‚„ã™ã„ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 5],
                tips: 'é‡ã™ãã‚‹é‡é‡ã¯è†ã‚’ç—›ã‚ã‚‹ã€‚',
                bodyPart: 'è„š'
            },
            'ã‚·ãƒ§ãƒ«ãƒ€ãƒ¼ãƒ—ãƒ¬ã‚¹': {
                type: 'compound',
                repRange: '6-10',
                description: 'è‚©å…¨ä½“ã‚’é›ãˆã‚‹åŸºæœ¬ç¨®ç›®ã€‚',
                strategy: 'é‡é‡ã¨å›æ•°ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆã',
                weightIncrements: [2.5, 1.25],
                tips: 'è‚©ã‚’ã™ãã‚ãªã„ã€‚ã‚³ã‚¢ã‚’ç· ã‚ã‚‹ã€‚',
                bodyPart: 'è‚©'
            },
            'ã‚µã‚¤ãƒ‰ãƒ¬ã‚¤ã‚º': {
                type: 'isolation',
                repRange: '12-20',
                description: 'è‚©å¹…ã‚’ä½œã‚‹ã€‚è»½ã„é‡é‡ã§é«˜å›æ•°ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [1, 1.25],
                tips: 'åå‹•ã‚’ä½¿ã‚ãªã„ã€‚è‚˜ã‚’è»½ãæ›²ã’ã‚‹ã€‚',
                bodyPart: 'è‚©'
            },
            'ãƒªã‚¢ãƒ‡ãƒ«ãƒˆ': {
                type: 'isolation',
                repRange: '12-20',
                description: 'å¾Œéƒ¨ä¸‰è§’ç­‹ã€‚å§¿å‹¢æ”¹å–„ã«ã‚‚é‡è¦ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [1, 1.25],
                tips: 'è»½ã„é‡é‡ã§ã—ã£ã‹ã‚ŠåŠ¹ã‹ã›ã‚‹ã€‚',
                bodyPart: 'è‚©'
            },
            'ãƒãƒ¼ãƒ™ãƒ«ã‚«ãƒ¼ãƒ«': {
                type: 'isolation',
                repRange: '8-12',
                description: 'ä¸Šè…•äºŒé ­ç­‹ã€‚åå‹•ã‚’ä½¿ã‚ãªã„ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 1.25],
                tips: 'è‚˜ã®ä½ç½®ã‚’å›ºå®šã€‚ä½“ã‚’æºã‚‰ã•ãªã„ã€‚',
                bodyPart: 'è…•'
            },
            'ãƒˆãƒ©ã‚¤ã‚»ãƒ—ã‚¹ãƒ—ãƒ¬ã‚¹ãƒ€ã‚¦ãƒ³': {
                type: 'isolation',
                repRange: '10-15',
                description: 'ä¸Šè…•ä¸‰é ­ç­‹ã€‚ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«é‡è¦–ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 5],
                tips: 'è‚˜ã‚’ä½“ã«å›ºå®šã€‚ä¼¸ã°ã—ãã‚‹ã€‚',
                bodyPart: 'è…•'
            },
            'ãƒ€ãƒ³ãƒ™ãƒ«ã‚«ãƒ¼ãƒ«': {
                type: 'isolation',
                repRange: '10-15',
                description: 'ä¸Šè…•äºŒé ­ç­‹ã€‚ç‰‡è…•ãšã¤é›†ä¸­å¯èƒ½ã€‚',
                strategy: 'å›æ•°ã‚’å„ªå…ˆçš„ã«å¢—ã‚„ã™',
                weightIncrements: [2.5, 1.25],
                tips: 'ãƒã‚¬ãƒ†ã‚£ãƒ–å‹•ä½œã‚’ã‚†ã£ãã‚Šã€‚',
                bodyPart: 'è…•'
            }
        };

        let workoutHistory = JSON.parse(localStorage.getItem('workoutHistory_v4')) || [];
        let volumeChart = null;
        let exerciseChart = null;

        function getRandomComment(type) {
            const comments = asukaComments[type];
            return comments[Math.floor(Math.random() * comments.length)];
        }

        function showAsukaComment(isOverload) {
            const commentDiv = document.getElementById('asukaComment');
            const comment = getRandomComment(isOverload ? 'success' : 'failure');
            commentDiv.textContent = comment;
            commentDiv.style.display = 'block';
            
            // 5ç§’å¾Œã«éè¡¨ç¤º
            setTimeout(() => {
                commentDiv.style.display = 'none';
            }, 5000);
        }

        function showExerciseInfo() {
            const exercise = document.getElementById('exercise').value;
            const infoDiv = document.getElementById('exerciseInfo');
            const prevSetDiv = document.getElementById('previousSetInfo');
            
            if (exercise && exerciseStrategies[exercise]) {
                const info = exerciseStrategies[exercise];
                infoDiv.style.display = 'block';
                infoDiv.innerHTML = `
                    <strong>${exercise}</strong><br>
                    <span class="badge">${info.type === 'compound' ? 'ã‚³ãƒ³ãƒ‘ã‚¦ãƒ³ãƒ‰' : 'ã‚¢ã‚¤ã‚½ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³'}</span>
                    <span class="badge">æ¨å¥¨å›æ•°: ${info.repRange}</span><br>
                    ${info.description}<br>
                    ğŸ’¡ ${info.tips}
                `;

                // å‰å›ã®ã‚»ãƒƒãƒˆæƒ…å ±ã‚’è¡¨ç¤º
                const sameExercise = workoutHistory.filter(w => w.exercise === exercise);
                if (sameExercise.length > 0) {
                    const lastWorkout = sameExercise[0];
                    prevSetDiv.style.display = 'block';
                    prevSetDiv.innerHTML = `
                        ğŸ“‹ <strong>å‰å›ã®è¨˜éŒ²:</strong> ${lastWorkout.weight}kg Ã— ${lastWorkout.reps}å› Ã— ${lastWorkout.sets}ã‚»ãƒƒãƒˆ
                    `;
                    
                    // è‡ªå‹•å…¥åŠ›
                    document.getElementById('weight').value = lastWorkout.weight;
                    document.getElementById('reps').value = lastWorkout.reps;
                    document.getElementById('sets').value = lastWorkout.sets;
                } else {
                    prevSetDiv.style.display = 'none';
                }
            } else {
                infoDiv.style.display = 'none';
                prevSetDiv.style.display = 'none';
            }
        }

        function recordWorkout() {
            const exercise = document.getElementById('exercise').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const reps = parseInt(document.getElementById('reps').value);
            const sets = parseInt(document.getElementById('sets').value);

            if (!exercise || !weight || !reps || !sets) {
                showMessage('ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const workout = {
                date: new Date().toISOString(),
                exercise,
                weight,
                reps,
                sets,
                volume: weight * reps * sets
            };

            workoutHistory.unshift(workout);
            localStorage.setItem('workoutHistory_v4', JSON.stringify(workoutHistory));

            // ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰åˆ¤å®š
            const sameExercise = workoutHistory.filter(w => w.exercise === exercise);
            const previousWorkout = sameExercise.length > 1 ? sameExercise[1] : null;
            
            let isOverload = false;
            if (previousWorkout) {
                isOverload = workout.volume > previousWorkout.volume;
            }
            
            showAsukaComment(isOverload);
            showSuggestion(workout);
            updateCharts();
            updateHistory();
            showMessage('âœ… ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¨˜éŒ²ã—ã¾ã—ãŸï¼', 'success');

            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢
            document.getElementById('weight').value = '';
            document.getElementById('reps').value = '';
            document.getElementById('sets').value = '';
        }

        function showSuggestion(workout) {
            const strategy = exerciseStrategies[workout.exercise];
            const section = document.getElementById('suggestionSection');
            const content = document.getElementById('suggestionContent');
            
            section.style.display = 'block';
            
            const currentVolume = workout.volume;
            
            // éå»ã®åŒã˜ç¨®ç›®ã®è¨˜éŒ²ã‚’å–å¾—
            const sameExercise = workoutHistory.filter(w => w.exercise === workout.exercise);
            const previousWorkout = sameExercise.length > 1 ? sameExercise[1] : null;
            
            let progressText = '';
            if (previousWorkout) {
                const progress = ((currentVolume - previousWorkout.volume) / previousWorkout.volume * 100).toFixed(1);
                if (progress > 0) {
                    progressText = `<div class="suggestion-item">ğŸ“ˆ å‰å›æ¯”: <strong>+${progress}%</strong> ç´ æ™´ã‚‰ã—ã„ï¼</div>`;
                } else if (progress < 0) {
                    progressText = `<div class="suggestion-item">ğŸ“‰ å‰å›æ¯”: <strong>${progress}%</strong> ç–²åŠ´ã‚„ä½“èª¿ã‚’è€ƒæ…®ã—ã¾ã—ã‚‡ã†</div>`;
                } else {
                    progressText = `<div class="suggestion-item">â¡ï¸ å‰å›ã¨åŒã˜è² è·</div>`;
                }
            }
            
            content.innerHTML = `
                <div class="suggestion-card">
                    <h3>${workout.exercise}</h3>
                    <div class="suggestion-item">
                        <strong>ä»Šå›ã®è¨˜éŒ²:</strong> ${workout.weight}kg Ã— ${workout.reps}å› Ã— ${workout.sets}ã‚»ãƒƒãƒˆ<br>
                        <strong>ç·è² è·é‡:</strong> ${currentVolume}kg
                    </div>
                    ${progressText}
                    <div class="suggestion-item">
                        <strong>ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰æˆ¦ç•¥:</strong> ${strategy.strategy}<br>
                        <strong>æ¨å¥¨å›æ•°ç¯„å›²:</strong> ${strategy.repRange}å›
                    </div>
                </div>
                
                <div class="suggestion-card">
                    <h3>æ¬¡å›ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ææ¡ˆ</h3>
                    ${generateSuggestions(workout, strategy)}
                </div>
            `;
        }

        function generateSuggestions(workout, strategy) {
            const suggestions = [];
            
            // è¤‡æ•°ã®é‡é‡å¢—åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ææ¡ˆ
            strategy.weightIncrements.forEach((increment, index) => {
                const newWeight = workout.weight + increment;
                const volumeWeight = newWeight * workout.reps * workout.sets;
                suggestions.push({
                    title: `é‡é‡ã‚’+${increment}kgå¢—ã‚„ã™`,
                    desc: `${newWeight}kg Ã— ${workout.reps}å› Ã— ${workout.sets}ã‚»ãƒƒãƒˆ`,
                    volume: volumeWeight,
                    increase: ((volumeWeight - workout.volume) / workout.volume * 100).toFixed(1),
                    priority: (index === 0 && strategy.strategy.includes('é‡é‡')) ? 'â­ æ¨å¥¨' : ''
                });
            });
            
            // å›æ•°ã‚’å¢—ã‚„ã™ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆ1å›ã¨2å›ï¼‰
            [1, 2].forEach((repIncrease, index) => {
                const newReps = workout.reps + repIncrease;
                const volumeReps = workout.weight * newReps * workout.sets;
                suggestions.push({
                    title: `å›æ•°ã‚’+${repIncrease}å›å¢—ã‚„ã™`,
                    desc: `${workout.weight}kg Ã— ${newReps}å› Ã— ${workout.sets}ã‚»ãƒƒãƒˆ`,
                    volume: volumeReps,
                    increase: ((volumeReps - workout.volume) / workout.volume * 100).toFixed(1),
                    priority: (index === 0 && strategy.strategy.includes('å›æ•°')) ? 'â­ æ¨å¥¨' : ''
                });
            });
            
            // ã‚»ãƒƒãƒˆæ•°ã‚’å¢—ã‚„ã™
            const newSets = workout.sets + 1;
            const volumeSets = workout.weight * workout.reps * newSets;
            suggestions.push({
                title: 'ã‚»ãƒƒãƒˆæ•°ã‚’å¢—ã‚„ã™',
                desc: `${workout.weight}kg Ã— ${workout.reps}å› Ã— ${newSets}ã‚»ãƒƒãƒˆ`,
                volume: volumeSets,
                increase: ((volumeSets - workout.volume) / workout.volume * 100).toFixed(1),
                priority: ''
            });

            // é‡é‡ã¨å›æ•°ã®çµ„ã¿åˆã‚ã›
            const smallWeightInc = strategy.weightIncrements[1] || strategy.weightIncrements[0];
            const combinedWeight = workout.weight + smallWeightInc;
            const combinedReps = workout.reps + 1;
            const volumeCombined = combinedWeight * combinedReps * workout.sets;
            suggestions.push({
                title: 'é‡é‡ã¨å›æ•°ã‚’ä¸¡æ–¹å¢—ã‚„ã™',
                desc: `${combinedWeight}kg Ã— ${combinedReps}å› Ã— ${workout.sets}ã‚»ãƒƒãƒˆ`,
                volume: volumeCombined,
                increase: ((volumeCombined - workout.volume) / workout.volume * 100).toFixed(1),
                priority: strategy.strategy.includes('ãƒãƒ©ãƒ³ã‚¹') ? 'â­ æ¨å¥¨' : ''
            });
            
            return suggestions.map((s, i) => `
                <div class="suggestion-item">
                    <strong>ã‚ªãƒ—ã‚·ãƒ§ãƒ³${i + 1}: ${s.title} ${s.priority}</strong><br>
                    ${s.desc}<br>
                    ç·è² è·é‡: ${s.volume.toFixed(1)}kg (+${s.increase}%)
                </div>
            `).join('');
        }

        function updateCharts() {
            updateVolumeChart();
            updateExerciseChart();
        }

        function updateVolumeChart() {
            const ctx = document.getElementById('volumeChart').getContext('2d');
            
            // æ—¥ä»˜ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
            const dateGroups = {};
            workoutHistory.forEach(w => {
                const date = new Date(w.date).toLocaleDateString('ja-JP');
                if (!dateGroups[date]) {
                    dateGroups[date] = 0;
                }
                dateGroups[date] += w.volume;
            });
            
            const dates = Object.keys(dateGroups).reverse().slice(-10);
            const volumes = dates.map(d => dateGroups[d]);
            
            if (volumeChart) {
                volumeChart.destroy();
            }
            
            volumeChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'ç·è² è·é‡ (kg)',
                        data: volumes,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function updateExerciseChart() {
            const ctx = document.getElementById('exerciseChart').getContext('2d');
            
            // ç¨®ç›®ã”ã¨ã®æœ€å¤§é‡é‡ã‚’é›†è¨ˆ
            const exerciseMax = {};
            workoutHistory.forEach(w => {
                if (!exerciseMax[w.exercise] || w.weight > exerciseMax[w.exercise]) {
                    exerciseMax[w.exercise] = w.weight;
                }
            });
            
            const exercises = Object.keys(exerciseMax);
            const maxWeights = exercises.map(e => exerciseMax[e]);
            
            if (exerciseChart) {
                exerciseChart.destroy();
            }
            
            exerciseChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: exercises,
                    datasets: [{
                        label: 'æœ€å¤§é‡é‡ (kg)',
                        data: maxWeights,
                        backgroundColor: 'rgba(102, 126, 234, 0.7)',
                        borderColor: '#667eea',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function updateHistory() {
            const content = document.getElementById('historyContent');
            
            if (workoutHistory.length === 0) {
                content.innerHTML = '<p style="color: #999;">ã¾ã ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                return;
            }
            
            // éƒ¨ä½ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
            const bodyPartGroups = {};
            workoutHistory.forEach(w => {
                const bodyPart = exerciseStrategies[w.exercise]?.bodyPart || 'ãã®ä»–';
                if (!bodyPartGroups[bodyPart]) {
                    bodyPartGroups[bodyPart] = [];
                }
                bodyPartGroups[bodyPart].push(w);
            });

            // éƒ¨ä½ã®é †åº
            const bodyPartOrder = ['èƒ¸', 'èƒŒä¸­', 'è„š', 'è‚©', 'è…•', 'ãã®ä»–'];
            
            let html = '';
            bodyPartOrder.forEach(bodyPart => {
                if (bodyPartGroups[bodyPart] && bodyPartGroups[bodyPart].length > 0) {
                    html += `<div class="history-group">`;
                    html += `<h3>ğŸ’ª ${bodyPart}</h3>`;
                    
                    bodyPartGroups[bodyPart].slice(0, 10).forEach(w => {
                        const date = new Date(w.date);
                        html += `
                            <div class="history-item">
                                <strong>${w.exercise}</strong><br>
                                ${date.toLocaleDateString('ja-JP')} ${date.toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit'})}<br>
                                ${w.weight}kg Ã— ${w.reps}å› Ã— ${w.sets}ã‚»ãƒƒãƒˆ<br>
                                <span style="color: #667eea;">ç·è² è·é‡: ${w.volume}kg</span>
                            </div>
                        `;
                    });
                    
                    html += `</div>`;
                }
            });
            
            content.innerHTML = html;
        }

        function exportToMarkdown() {
            if (workoutHistory.length === 0) {
                showMessage('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“', 'error');
                return;
            }
            
            let markdown = `# ğŸ‹ï¸ ç­‹ãƒˆãƒ¬è¨˜éŒ²\n\n`;
            markdown += `æœ€çµ‚æ›´æ–°: ${new Date().toLocaleString('ja-JP')}\n\n`;
            markdown += `---\n\n`;
            
            // éƒ¨ä½ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
            const bodyPartGroups = {};
            workoutHistory.forEach(w => {
                const bodyPart = exerciseStrategies[w.exercise]?.bodyPart || 'ãã®ä»–';
                if (!bodyPartGroups[bodyPart]) {
                    bodyPartGroups[bodyPart] = {};
                }
                if (!bodyPartGroups[bodyPart][w.exercise]) {
                    bodyPartGroups[bodyPart][w.exercise] = [];
                }
                bodyPartGroups[bodyPart][w.exercise].push(w);
            });

            // éƒ¨ä½ã®é †åº
            const bodyPartOrder = ['èƒ¸', 'èƒŒä¸­', 'è„š', 'è‚©', 'è…•', 'ãã®ä»–'];
            
            bodyPartOrder.forEach(bodyPart => {
                if (bodyPartGroups[bodyPart]) {
                    markdown += `# ${bodyPart}\n\n`;
                    
                    for (const [exercise, workouts] of Object.entries(bodyPartGroups[bodyPart])) {
                        const strategy = exerciseStrategies[exercise];
                        markdown += `## ${exercise}\n\n`;
                        
                        if (strategy) {
                            markdown += `**ç¨®ç›®æƒ…å ±**\n`;
                            markdown += `- ã‚¿ã‚¤ãƒ—: ${strategy.type === 'compound' ? 'ã‚³ãƒ³ãƒ‘ã‚¦ãƒ³ãƒ‰' : 'ã‚¢ã‚¤ã‚½ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³'}\n`;
                            markdown += `- æ¨å¥¨å›æ•°: ${strategy.repRange}å›\n`;
                            markdown += `- æˆ¦ç•¥: ${strategy.strategy}\n\n`;
                        }
                        
                        markdown += `| æ—¥æ™‚ | é‡é‡ | å›æ•° | ã‚»ãƒƒãƒˆæ•° | ç·è² è·é‡ |\n`;
                        markdown += `|------|------|------|----------|----------|\n`;
                        
                        workouts.forEach(w => {
                            const date = new Date(w.date);
                            const dateStr = `${date.getMonth()+1}/${date.getDate()} ${date.getHours()}:${String(date.getMinutes()).padStart(2,'0')}`;
                            markdown += `| ${dateStr} | ${w.weight}kg | ${w.reps}å› | ${w.sets}ã‚»ãƒƒãƒˆ | ${w.volume}kg |\n`;
                        });
                        
                        // é€²æ—åˆ†æ
                        if (workouts.length >= 1) {
                            const latest = workouts[0];
                            
                            if (workouts.length >= 2) {
                                const previous = workouts[1];
                                const progress = ((latest.volume - previous.volume) / previous.volume * 100).toFixed(1);
                                
                                markdown += `\n**æœ€æ–°ã®é€²æ—:** `;
                                if (progress > 0) {
                                    markdown += `ğŸ“ˆ å‰å›æ¯” +${progress}% (è‰¯å¥½ï¼)\n`;
                                } else if (progress < 0) {
                                    markdown += `ğŸ“‰ å‰å›æ¯” ${progress}%\n`;
                                } else {
                                    markdown += `â¡ï¸ å‰å›ã¨åŒã˜\n`;
                                }
                            }
                            
                            // æœ€å¤§é‡é‡
                            const maxWeight = Math.max(...workouts.map(w => w.weight));
                            markdown += `**æœ€å¤§é‡é‡è¨˜éŒ²:** ${maxWeight}kg\n\n`;
                        }
                        
                        markdown += `\n`;
                    }
                }
            });
            
            // çµ±è¨ˆ
            markdown += `---\n\n`;
            markdown += `## ğŸ“Š çµ±è¨ˆæƒ…å ±\n\n`;
            markdown += `- **ç·ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å›æ•°:** ${workoutHistory.length}å›\n`;
            
            const uniqueExercises = [...new Set(workoutHistory.map(w => w.exercise))];
            markdown += `- **è¨˜éŒ²ã—ã¦ã„ã‚‹ç¨®ç›®æ•°:** ${uniqueExercises.length}ç¨®ç›®\n`;
            
            const totalVolume = workoutHistory.reduce((sum, w) => sum + w.volume, 0);
            markdown += `- **ç´¯è¨ˆç·è² è·é‡:** ${totalVolume.toLocaleString()}kg\n`;
            
            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            const blob = new Blob([markdown], { type: 'text/markdown;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `workout-log-${new Date().toISOString().split('T')[0]}.md`;
            a.click();
            URL.revokeObjectURL(url);
            
            showMessage('âœ… ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸï¼', 'success');
        }

        function clearAllData() {
            if (confirm('æœ¬å½“ã«å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                workoutHistory = [];
                localStorage.removeItem('workoutHistory_v4');
                updateCharts();
                updateHistory();
                document.getElementById('suggestionSection').style.display = 'none';
                showMessage('âœ… å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'success');
            }
        }

        function showMessage(text, type) {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.className = `message ${type}`;
            msg.style.display = 'block';
            setTimeout(() => {
                msg.style.display = 'none';
            }, 3000);
        }

        // åˆæœŸåŒ–
        window.onload = function() {
            updateCharts();
            updateHistory();
        };
    </script>
</body>
</html>
